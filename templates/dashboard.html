<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - EyeCare Monitor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link href="https://unpkg.com/lucide-icons/dist/umd/lucide.css" rel="stylesheet">
    <style>
      .animated-gradient {
        background: linear-gradient(-45deg, #6366f1, #818cf8, #4f46e5, #4338ca);
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
      }
      @keyframes gradient {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      .glass-card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
    </style>
  </head>
  <body class="animated-gradient min-h-screen">
    <!-- Sidebar Navigation -->
    <div id="sidebar" class="fixed top-0 left-0 h-full w-64 bg-white/95 backdrop-blur-md transform -translate-x-full transition-transform duration-300 ease-in-out z-50 shadow-xl md:hidden">
      <div class="p-6">
        <div class="flex items-center justify-between mb-8">
          <div class="flex items-center">
            <i class="lucide-eye text-indigo-600 h-8 w-8"></i>
            <span class="ml-3 text-xl font-bold text-gray-800">EyeCare</span>
          </div>
          <button onclick="toggleSidebar()" class="p-2 rounded-md text-gray-600 hover:text-indigo-600 focus:outline-none">
            <i class="lucide-x h-6 w-6"></i>
          </button>
        </div>
        <nav class="space-y-4">
          <a href="/dashboard" class="block px-4 py-2 rounded-lg bg-indigo-600 text-white">Dashboard</a>
          <a href="/previous-records" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50">Records</a>
          <a href="/doctor-suggestions" class="block px-4 py-2 rounded-lg text-gray-700 hover:bg-indigo-50">Doctor</a>
        </nav>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="glass-card shadow-lg">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center">
            <div class="md:hidden ml-3">
              <button onclick="toggleMobileMenu()" class="inline-flex items-center justify-center p-2 rounded-md text-indigo-600 hover:text-indigo-700 focus:outline-none">
                <i id="menu-icon" class="bi bi-list h-6 w-6"></i> <!-- Bootstrap Icon -->
              </button>
            </div>
            <div class="md:hidden ml-3">
              <button onclick="toggleSidebar()" class="inline-flex items-center justify-center p-2 rounded-md text-indigo-600 hover:text-indigo-700 focus:outline-none">
                <i class="lucide-menu h-6 w-6"></i>
              </button>
            </div>
            <div class="hidden md:block">
              <div class="ml-10 flex items-baseline space-x-4">
                <a href="/dashboard" class="bg-indigo-600 text-white px-3 py-2 rounded-md text-sm font-medium">Dashboard</a>
                <a href="/previous-records" class="text-gray-700 hover:bg-indigo-500 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200">Records</a>
                <a href="/doctor-suggestions" class="text-gray-700 hover:bg-indigo-500 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200">Doctor</a>
              </div>
            </div>
          </div>
          <div class="flex items-center">
            <button class="bg-indigo-100 p-2 rounded-full text-indigo-600 hover:bg-indigo-200 transition-colors duration-200">
              <i class="lucide-bell h-5 w-5"></i>
            </button>
            <button class="ml-4 bg-indigo-100 p-2 rounded-full text-indigo-600 hover:bg-indigo-200 transition-colors duration-200">
              <i class="lucide-user h-5 w-5"></i>
            </button>
          </div>
        </div>
      </div>
    </nav>
    <script>
      function toggleMobileMenu() {
        const mobileMenu = document.getElementById('mobile-menu');
        const menuIcon = document.getElementById('menu-icon');
        mobileMenu.classList.toggle('hidden');

        if (mobileMenu.classList.contains('hidden')) {
          menuIcon.classList.remove('lucide-x');
          menuIcon.classList.add('lucide-menu');
        } else {
          menuIcon.classList.remove('lucide-menu');
          menuIcon.classList.add('lucide-x');
        }
      }
    </script>


    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- IOP Reading Card -->
        <div class="glass-card rounded-2xl shadow-xl p-6 transform hover:scale-[1.02] transition-all duration-300">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-bold text-gray-800">Current IOP Reading</h3>
            <i class="lucide-activity text-indigo-600 h-6 w-6"></i>
          </div>

      <!-- Mobile menu -->
      <div id="mobile-menu" class="hidden md:hidden bg-white/90 backdrop-blur-md">
        <div class="px-2 pt-2 pb-3 space-y-1">
          <a href="/dashboard" class="block px-3 py-2 rounded-md text-base font-medium bg-indigo-600 text-white">Dashboard</a>
          <a href="/previous-records" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-indigo-500 hover:text-white transition-colors duration-200">Records</a>
          <a href="/doctor-suggestions" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-indigo-500 hover:text-white transition-colors duration-200">Doctor</a>
        </div>
      </div>

      <script>
        function toggleSidebar() {
          const sidebar = document.getElementById('sidebar');
          if (sidebar.classList.contains('-translate-x-full')) {
            sidebar.classList.remove('-translate-x-full');
          } else {
            sidebar.classList.add('-translate-x-full');
          }
        }
      </script>

          <div class="flex items-center justify-center py-6">
            <div class="text-center">
              <div class="text-5xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                {{ latest_iop }} mmHg
              </div>
              <p class="mt-2 text-gray-600">Last updated: Just now</p>
            </div>
          </div>
          <div class="mt-4 flex justify-center">
            <form method="POST" action="{{ url_for('take_new_reading') }}">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200">
              Take New Reading
            </button>
            </form>
          </div>
        </div>

        <!-- Stats Card -->
        <div class="glass-card rounded-2xl shadow-xl p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-bold text-gray-800">Daily Statistics</h3>
            <i class="lucide-bar-chart text-indigo-600 h-6 w-6"></i>
          </div>
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <span class="text-gray-600">Average Reading</span>
              <span class="font-semibold text-gray-800">{{ avg_reading }} mmHg</span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-gray-600">Highest Reading</span>
              <span class="font-semibold text-gray-800">{{ max_reading }} mmHg</span>
            </div>
            <div class="flex items-center justify-between">
              <span class="text-gray-600">Lowest Reading</span>
              <span class="font-semibold text-gray-800">{{ min_reading }} mmHg</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Recommendations -->
      <div class="mt-6 glass-card rounded-2xl shadow-xl p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-xl font-bold text-gray-800">Recommendations</h3>
          <i class="lucide-heart-pulse text-indigo-600 h-6 w-6"></i>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="p-4 bg-indigo-50 rounded-lg">
            <i class="lucide-droplets text-indigo-600 h-8 w-8 mb-2"></i>
            <h4 class="text-1xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Use Eye Drops</h4>
            <p class="text-sm text-gray-600">Remember to apply prescribed eye drops every 6 hours</p>
          </div>
          <div class="p-4 bg-indigo-50 rounded-lg">
            <i class="lucide-clock text-indigo-600 h-8 w-8 mb-2"></i>
            <h4 class="text-1xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Take Breaks</h4>
            <p class="text-sm text-gray-600">Follow the 20-20-20 rule while working</p>
          </div>
          <div class="p-4 bg-indigo-50 rounded-lg">
            <i class="lucide-calendar text-indigo-600 h-8 w-8 mb-2"></i>
            <h4 class="text-1xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Next Checkup</h4>
            <p class="text-sm text-gray-600">Schedule your next doctor visit in 2 weeks</p>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.querySelector('button').addEventListener('click', function(event) {
          event.preventDefault();

          fetch('/take_new_reading', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
                  'X-CSRFToken': '{{ csrf_token() }}', 
              },
          })
          .then(response => response.text())
          .then(html => {
              document.querySelector('.dashboard-content').innerHTML = html;
          });
      });
   </script>

  </body>
</html>